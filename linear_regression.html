<!DOCTYPE HTML>
<html>
	<head>
		<title>Linear Regression Model Showcasing a Machine Learning Algorithm</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="index.html">Linear Regression Model Showcasing a Machine Learning Algorithm</a></h1>
						<nav>
							<a href="#menu">Menu</a>
						</nav>
					</header>

				<!-- Menu -->
					<nav id="menu">
						<div class="inner">
							<h2>Menu</h2>
							<ul class="links">
								<li><a href="index.html">Home</a></li>
								<li><a href="qualified_business_analyst.html">Qualified Business Analyst</a></li>
								<li><a href="data_analyst.html">Data Analyst Showcase</a></li>
							</ul>
							<a href="#" class="close">Close</a>
						</div>
					</nav>

				<!-- Wrapper -->
					<section id="wrapper">
						<header>
							<div class="inner">
								<h2>Linear Regression Model Showcasing a Machine Learning Algorithm</h2>
								<p>On this page I will showcase Linear regression which allows the user to visualise the machine
                                    learning algorithm behind it. This was built with a completley random dataset I found that
									gives specific countries coffee exports.
								</p>
							</div>
						</header>

						<!-- Content -->
							<div class="wrapper">
								<div class="inner">
									<section>
										<h3>The code at a glance</h3>
										<p><span class="image right"><pre>
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
import plotly.express as px
import plotly.graph_objects as go

data = pd.read_csv("C:/Users/Caedmon/Documents/BA_DA/Coffee_export.csv")
print(data.head())
x = data["1990"].values.reshape(-1, 1)
y = data["1995"]

model = LinearRegression()
model.fit(x, y)
x_range = np.linspace(x.min(), x.max(), 1000)
y_range = model.predict(x_range.reshape(-1, 1))

fig = px.scatter (data, x="1990", y="1995", opacity=0.65)
fig.add_traces(go.Scatter(x=x_range, y=y_range, name="Linear Regression"))

print(y_range)

fig.show()</pre></span></p>
									</section>
									
									<section>
										<h3>Importing the Necessary Libraries</h3>
										<p><span class="image left"><pre>
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
import plotly.express as px
import plotly.graph_objects as go</pre></span></p>
										<p>For the first step in this code I had to install the necessary libraries.
											<i>pandas</i> for data manipulation, <i>numpy</i> for numerical operarions, <i>train_test_split</i> and <i>LinearRegression</i>
										from <i>sklearn.model_selection</i> for splitting the data and creating a linear regression model, and <i>plotly.express</i>
										and <i>plotly.graph_objects</i> for creating interactive visualisations. </p>
										</section>
										
										<section>
										<h3>Reading the Data</h3>
										<p><span class="image right"><pre>
data = pd.read_csv("C:/Users/Caedmon/Documents/Learning_Python/Coffee_export.csv")</pre></span></p>
										<p>The next section is where the code reads a CSV file, in this example 'Coffee_exports.csv' using the <i>pd.read_csv</i>
											function and stores it in the <i>data</i> DataFrame.
										</p>
										</section>
										
										<section>
										<h3>Print Head of Data</h3>
										<p><span class="image left"><pre>
print(data.head())</pre></span></p>
										<p>This section prints the first few rows of the dataset using <i>print(data.head())</i> to give an overview of the data
											structure.
										</p>
										</section>

										<section>
										<h3>Data Preperation</h3>
										<p><span class="image right"><pre>
x = data["1990"].values.reshape(-1, 1)
y = data["1995"]</pre></span></p>	
										<p>The code extracts the feature <i>(x)</i> and target <i>(y)</i> variables from the dataset. <i>x</i> is the "1990" column reshaped 
											to a 2D array, and <i>y</i> is the "1995" column.</p>
										</section>

										<section>
										<h3>Linear Regression Model</h3>
										<p><span class="image left"><pre>
model = LinearRegression()</pre></span></p>
										<p>A Linear Regression model is created using <i>LinearRegression()</i>.</p>
										</section>
										
										<section>
										<h3>Model Training</h3>
										<p><span class="image right"><pre>
model.fit(x, y)</pre></span></p>
										<p>The model is trained using the <i>fit</i> method with the feature <i>(x)</i> and target <i>(y)</i> data.</p>
										</section>

										<section>
										<h3>Generate Prediction Range</h3>
										<p><span class="image left"><pre>
x_range = np.linspace(x.min(), x.max(), 1000)</pre></span></p>
										<p><i>x_range</i> is created as a range of values between the <i>min</i> and <i>max</i> values
											of the original "1990" column.</p>
										</section>

										<section>
										<h3>Make Predictions</h3>
										<p><span class="image right"><pre>
y_range = model.predict(x_range.reshape(-1, 1))</pre></span></p>
										<p>The trained model is used to predict the corresponding <i>y</i> values for the <i>x_range</i>.</p>
										</section>

										<section>
										<h3>Visualisation</h3>
										<p><span class="image left"><pre>
fig = px.scatter (data, x="1990", y="1995", opacity=0.65)
fig.add_traces(go.Scatter(x=x_range, y=y_range, name="Linear Regression"))</pre></span></p>
										<p>A scatter plot is created using <i>px.scatter</i> from <i>Plotly Express</i>, and a line plot for the
											linear regression line is aded using <i>go.scatter</i>.</p>
										</section>

										<section>
										<h3>Print Predicted Values</h3>
										<p><span class="image right"><pre>
print(y_range)</pre></span></p>
										<p>Although self-explanatory, I will detail regardless. The predicted <i>y</i> values for the <i>x_range</i> are
											printed.</p>
										</section>

										<section>
										<h3>Display the Plot</h3>
										<p><span class="image left"><pre>
fig.show()</pre></span></p>
										<p>The final plot is displayed using <i>fig.show()</i>.</p>
										</section>

										<section>
										<h2>Output</h2>
										<p><span class="i">Once the code is run we should recieve the following output:</span></p>
										<p><span class="image"><img src="images/Linear_ss.png" alt="" height="400px" width="800px"></span></p>
										<p><span class="image"> The above image shows a Linear Regression line which is output by the code and shows the 'trend' or 'mean'
											values of the data read by the program. As well as this output, the code also requests the next 1000
											iterations as a prediction. Thus the following output should also be given:</span></p>
										<p><span class="image"><img src="images/Predict.png" alt="" height="400px" width="400px"></span></p>
										</section>
								</div>
							</div>

					</section>

					<!-- Footer -->
					<section id="footer">
						<div class="inner">
							<h2 class="major">Get in touch</h2>
							<p>If you are interested in my skillset and wish to get in touch, please find my details below</p>
							<ul class="contact">
								<li class="icon solid fa-phone">(+44) 7727899527</li>
								<li class="icon solid fa-envelope"><a href="#">danielsmith77@btinternet.com</a></li>
								<li class="icon brands fa-linkedin"><a href="#">www.linkedin.com/in/daniel-smith-a9470b159</a></li>
								<li class="icon brands fa-facebook-f"><a href="#">https://www.facebook.com/profile.php?id=1460064952</a></li>
								<li class="icon business fa-file-alt"><a href="CV.docx">CV</a></li>
							</ul>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>